## 가스공급량 수요예측 모델개발

- 한국가스공사의 시간단위 공급량 내부 데이터를 활용하여 일간 공급량을 예측하는 인공지능 모델 개발

### 0. 구조
- data
- main.py로 동작
- preprocessing.py (전처리)
- model.py (모델 훈련 및 예측)
- visualization.py (예측 결과 시각화)
- gas.ipynb (실제 개발 코드, 이후 분기 진행 / 아래 훈련과정 확인 가능)
    
### 1. 데이터
- 공공데이터 - 한국가스공사_시간별 공급량_20181231.csv
    
    [한국가스공사_시간별 공급량_20181231](https://www.data.go.kr/data/15091497/fileData.do)
    
- 2013년부터 2018년까지의 시간별 공급량
- 연/월/일/시간 단위로 구분
- 구분: 영업비밀(A,B,C.. 로 나타냄)
  - 용도별 구분 혹은 지역별 공급사(지역)라고 가정
    - 용도별 구분
      - 민수용 : 주택용, 업무난방용, 일반용, 냉난방공조용, 열병합용, 연료전지용, 열전용설비용
      - 산업용 : 산업용, 수송용
    - 지역별 공급사
        - 구분→지역단위(서울, 경기, 강원, 전라, 등 )
            
### 2. 모델
- 모델 선정: LSTM
    
- 선정이유:
    사용 데이터 → (가스 공급량 데이터-시계열 데이터)
  
    시계열 데이터를 사용하여 예측하기에 RNN 계열 모델이 적합
  
    하지만 장기적인 기간의 데이터를 학습할 때 기본 RNN은 단기 기억 문제로 인해 긴 시퀀스를 처리하는 데 어려움
  
  → 이러한 단점 극복한 모델 LSTM
  
    LSTM: 내부 메모리 셀을 사용하여 장기 의존성을 더 잘 학습, 긴 시퀀스 처리를 위해 게이트 메커니즘을 사용하여 기울기 소실문제를 완화,
          그레디언트를 안정적으로 나오게 함
  
    → 2013부터 2018년의 월일시간별 데이터이기 때문에 대량의 장기적 데이터를 학습해야 하고,
      시퀀스의 길이도 다양하게 조절할 계획이기 때문에 LSTM을 선택하였다.
      
- 모델 훈련 과정(학습 방향)

      0. activation = tanh / optimizer = adam / loss = mse / metrics = mae
  
      1. layer를 1-3-5 순으로 늘려서 학습
  
      2. unit을 20 → 40
  
      3. learning rate 0.001 → 0.0001
  
      4. 시퀀스 7→30→3으로 변경
  
      5. 배치크기 32 → 16
  
      6. 이후 가장 잘 나온 parameter 사용해서 종합 모델 구축
     
- 최종 모델 파라미터 선택: seq7, layer3, unit40
      
### 3. 결과
- 2013-17 데이터를 train, 2018 데이터를 test로 사용
- 평가지표 mse, mae 사용
- test MSE 0.0005 test MAE 0.0127

  ![image](https://github.com/dohyeonnlee/gas_supply_LSTM/assets/99801524/3b4fca7a-f709-444f-adb5-00e1cba75759)

### 4. 정리
📌[notion](https://caramel-shad-ee4.notion.site/aa323c1478684ea88606d0c00f6ffe00?pvs=4)
